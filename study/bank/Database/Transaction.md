# Transaction

<br>


### ACID

Atomicity(원자성) 트랜잭션은 하나의 작업이며 나누어 실행할 수가 없다. 하나가 실패해도 전체가 실패다.

Consistency(일관성) 트랜잭션은 실행전후로 db의 상태가 일관성을 유지해야 한다.

Isolation(격리성) 트랜잭션 각각이 다른 트랜잭션과 독립되어야 한다.

Durability(지속성) 트랜잭션이 마무리되면 결과가 영속성을 가져야한다.

<br>


### 트랜잭션 전파(Propagation)

ACID중 Isolation은 트랜잭션이 서로의 상태를 확인 할수 없게격리되어 있다가 트랜잭션이 완료되어야만 내역을 확인할수 있습니다. 그 격리수준을 조절해야되는데 기본적으로는 REQUIRED값을 많이 사용됩니다.

<br>


RQUIRED(기본값): 현재 트랜잭션이 실행된 상태라면 해당 트랜잭션의 일부로 실행되고 아니면 새로운 트랜잭션을 생성합니다.

SUPPORTS: 트랜잭션이 실행되면 해당 트랜잭션의 일부로 실행이 되나 없으면 트랜잭션 없이 실행됩니다.

MANDATORY: 트랜잭션이 실행되면 해당 트랜잭션의 일부로 실행이 되나 없으면 예외 발생

NEVER: 트랜잭션이 실행되면 예외발생, 없을경우 트랜잭션 없이 실행됩니다.

NOT_SUPPORTED: 트랜잭션이 실행된 상태라면 해당 트랜잭션을 대기시킨뒤 트랜잭션 없이 실행합니다.

REQUIRES_NEW: 트랜잭션이 실행된 상태라면 해당 트랜잭션을 대기시킨뒤 트랜잭션을 새로 실행합니다.


격리 수준을 높이면 문제는 덜 발생하지만 성능이 떨어집니다.

Drity Read : 아직 커밋되지 않는 수정사항을 읽게되는문제

Non-Repeatable Read : 한번 읽은 열의 내용이 다른 트랜잭션의 커밋으로 바뀌어 있는 문제

Phantom Read: 한번의 트랜잭션에서 두번조회를 할때 다른 트랜잭션의 커밋으로 다른 데이터를 받게되는 문제.

<br>



DEFAULT(기본값) : 사용하는 DB의 설정에 따라 격리.

READ_UNCOMMITED:  서로 커밋하지 않아도 읽을 수 있음. 위의 3가지 문제가 전부발생

READ_COMMITED:  커밋된 데이터를 읽을 수 있음. 3가지중 Drity Read만 방지

REPEATABLE_READ :  아직 커밋되지 않는 정보의 읽기를 방지. Phantom Read 현상만 발생 가능.

SERIALIZABLE: 동시에 실행되는 트랜잭션을 연쇄적(Serial)로 실행. 모든 문제가 방지되지만 트랜잭션이 동시에 실행 불가능.
